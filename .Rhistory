rsconnect::setAccountInfo(name='tinystats', token='F4DF3EFB2484EE63263848F807E27B8C', secret='wB31GWYutjUtf9iTVsf1YkvhPZJcE6+i76ssW281')
here::here()
rmarkdown::shiny_prerendered_clean('learnr-test/learnr-test.Rmd')
unlink('learnr-test/learnr-test_cache', recursive = TRUE)
unlink('learnr-test/learnr-test_cache', recursive = TRUE)
install.packages("gradethis")
remotes::install_github("rstudio-education/gradethis")
log(7.2)
ex <- read.csv("~/Downloads/CKJLQP1CTC13_0log2/Expression.csv", head=F)
co <- read.csv("~/Downloads/CKJLQP1CTC13_0log2/Columns.csv", head=T)
rownames(ex) <- c("ENS", "SHANK3")
d <- cbind(co, t(ex[,2:525]))
d <- d[d$donor_age %in% c("4 mos", "10 mos", "1 yrs", "2 yrs", "3 yrs"),]
d <- d[d$structure_name=="cerebellar cortex",]
d$scale <- ifelse(grepl(" yrs", d$donor_age), 12, 1)
d$age <- as.numeric(gsub(" mos| yrs", "", d$donor_age))
d$Age <- d$age*d$scale
d$express <- d$SHANK3/max(d$SHANK3)
ex2 <- read.csv("~/Downloads/L5JSD31C4C11_0log2/Expression.csv", head=F)
co2 <- read.csv("~/Downloads/L5JSD31C4C11_0log2/Columns.csv", head=T)
rownames(ex2) <- c("OXTR")
d2 <- cbind(co2, t(ex2[,2:525]))
d2 <- d2[d2$donor_age %in% c("4 mos", "10 mos", "1 yrs", "2 yrs", "3 yrs"),]
d2 <- d2[d2$structure_name=="cerebellar cortex",]
d2$scale <- ifelse(grepl(" yrs", d2$donor_age), 12, 1)
d2$age <- as.numeric(gsub(" mos| yrs", "", d2$donor_age))
d2$Age <- d2$age*d2$scale
ex3 <- read.csv("~/Downloads/9KD2CS9C12_3log2/Expression.csv", head=F)
co3 <- read.csv("~/Downloads/9KD2CS9C12_3log2/Columns.csv", head=T)
rownames(ex3) <- c("FOS")
d3 <- cbind(co3, t(ex3[,2:525]))
d3 <- d3[d3$donor_age %in% c("4 mos", "10 mos", "1 yrs", "2 yrs", "3 yrs"),]
d3 <- d3[d3$structure_name=="cerebellar cortex",]
d3$scale <- ifelse(grepl(" yrs", d3$donor_age), 12, 1)
d3$age <- as.numeric(gsub(" mos| yrs", "", d3$donor_age))
d3$Age <- d3$age*d3$scale
p <- ggplot(data=d, aes(x=Age, y=express))+geom_point()+geom_smooth(se=F)+theme_classic()
p
library(ggplot2)
p <- ggplot(data=d, aes(x=Age, y=express))+geom_point()+geom_smooth(se=F)+theme_classic()
p
p <- ggplot(data=d, aes(x=Age, y=express))+geom_point()+geom_smooth(se=F, span=0.25)+theme_classic()
p
p <- ggplot(data=d, aes(x=Age, y=express))+geom_point()+geom_smooth(se=F, span=0.5)+theme_classic()
p
p <- ggplot(data=d, aes(x=Age, y=express))+geom_point()+geom_smooth(se=F, span=0.75)+theme_classic()
p
library(splines)
fit<-lm(SHANK3 ~ bs(Age,knots = c(12,24)),data = Wage )
fit<-lm(SHANK3 ~ bs(Age,knots = c(12,24)),data = d )
fit
summary(fit)
#Plotting the Regression Line to the scatterplot
plot(Age,Shank3,col="grey",xlab="Age",ylab="SHANK3")
#Plotting the Regression Line to the scatterplot
plot(Age,Shank3,col="grey",xlab="Age",ylab="SHANK3", data=d)
#Plotting the Regression Line to the scatterplot
plot(Age,SHANK3,col="grey",xlab="Age",ylab="SHANK3", data=d)
#Plotting the Regression Line to the scatterplot
attach(d)
plot(Age,SHANK3,col="grey",xlab="Age",ylab="SHANK3", data=d)
plot(Age,SHANK3,col="grey",xlab="Age",ylab="SHANK3")
attach(d)
agelims<-range(Age)
#Generating Test Data
age.grid<-seq(from=agelims[1], to = agelims[2])
library(splines)
fit<-lm(SHANK3 ~ bs(Age,knots = c(12,24)),data = d)
summary(fit)
#Plotting the Regression Line to the scatterplot
attach(d)
agelims<-range(Age)
#Generating Test Data
age.grid<-seq(from=agelims[1], to = agelims[2])
plot(Age,SHANK3,col="grey",xlab="Age",ylab="SHANK3")
points(age.grid,predict(fit,newdata = list(age=age.grid)),col="darkgreen",lwd=2,type="l")
#adding cutpoints
abline(v=c(12,24),lty=2,col="darkgreen")
agelims
age.grid
age.grid<-seq(from=agelims[1], to = agelims[2])
plot(Age,SHANK3,col="grey",xlab="Age",ylab="SHANK3")
predict(fit,newdata = list(age=age.grid))
#adding cutpoints
abline(v=c(12,24),lty=2,col="darkgreen")
p <- ggplot(data=d, aes(x=Age, y=SHANK3))+geom_point()+geom_smooth(se=F, method = "lm", formula = y=bs(x, knots=c(12, 24)))+theme_classic()
p <- ggplot(data=d, aes(x=Age, y=SHANK3))+geom_point()+geom_smooth(se=F, method = "glm", formula = y=bs(x, knots=c(12, 24)))+theme_classic()
p <- ggplot(data=d, aes(x=Age, y=SHANK3))+geom_point()+geom_smooth(se=F, method = "glm", formula = y~bs(x, knots=c(12, 24)))+theme_classic()
p
p <- ggplot(data=d, aes(x=Age, y=SHANK3))+geom_point()+geom_smooth(se=F, method = "glm", formula = y~bs(x, knots=c(10, 24)))+theme_classic()
p
ex <- read.csv("~/Downloads/CKJLQP1CTC13_0log2/Expression.csv", head=F)
co <- read.csv("~/Downloads/CKJLQP1CTC13_0log2/Columns.csv", head=T)
rownames(ex) <- c("ENS", "SHANK3")
d <- cbind(co, t(ex[,2:525]))
d
table(d$structure_name)
d <- cbind(co, t(ex[,2:525]))
d <- d[d$donor_age %in% c("4 mos", "10 mos", "1 yrs", "2 yrs", "3 yrs"),]
d <- d[d$structure_name=="ventrolateral prefrontal cortex",]
d$scale <- ifelse(grepl(" yrs", d$donor_age), 12, 1)
d$age <- as.numeric(gsub(" mos| yrs", "", d$donor_age))
d$Age <- d$age*d$scale
d$express <- d$SHANK3/max(d$SHANK3)
d
p <- ggplot(data=d, aes(x=Age, y=SHANK3))+geom_point()+geom_smooth(se=F, method = "glm", formula = y~bs(x, knots=c(10, 24)))+theme_classic()
p
p <- ggplot(data=d, aes(x=Age, y=SHANK3))+geom_point()+geom_smooth(se=F, method = "glm", formula = y~bs(x, knots=c(20)))+theme_classic()
p
fit<-lm(SHANK3 ~ bs(Age,knots = c(12,24)),data = d)
summary(fit)
fit<-lm(SHANK3 ~ bs(Age,knots = c(20)),data = d)
summary(fit)
p <- ggplot(data=d, aes(x=Age, y=SHANK3))+geom_point()+geom_smooth(se=F, method = "glm", formula = y~bs(x, knots=c(20)))+theme_classic()
p
p <- ggplot(data=d, aes(x=Age, y=SHANK3))+geom_point()+geom_smooth(se=F, method = "glm", formula = y~bs(x, knots=c(17)))+theme_classic()
p
p <- ggplot(data=d, aes(x=Age, y=SHANK3))+geom_point()+geom_smooth(se=F, method = "glm", formula = y~bs(x, knots=c(20)))+theme_classic()
p
d <- cbind(co, t(ex[,2:525]))
d <- d[d$donor_age %in% c("4 mos", "10 mos", "1 yrs", "2 yrs", "3 yrs"),]
#d <- d[d$structure_name=="ventrolateral prefrontal cortex",]
d$scale <- ifelse(grepl(" yrs", d$donor_age), 12, 1)
d$age <- as.numeric(gsub(" mos| yrs", "", d$donor_age))
d$Age <- d$age*d$scale
d$express <- d$SHANK3/max(d$SHANK3)
d
table(d$Age)
p <- ggplot(data=d, aes(x=Age, y=SHANK3))+geom_point()+geom_smooth(se=F, method = "glm", formula = y~bs(x, knots=c(20)))+theme_classic()
p
p <- ggplot(data=d, aes(x=Age, y=SHANK3))+geom_point()+geom_smooth(se=F, method = "glm", formula = y~bs(x, knots=c(12,24)))+theme_classic()
p
gam_mod <- gam(SHANK3 ~ s(Age), data = d)
summary(gam_mod)
plot(gam_mod, residuals = T)
library(mgcv)
gam_mod <- gam(SHANK3 ~ s(Age), data = d)
summary(gam_mod)
plot(gam_mod, residuals = T)
p <- ggplot(data=d, aes(x=Age, y=express))+geom_point()+geom_smooth(se=F)+theme_classic()
p
p <- ggplot(data=d, aes(x=Age, y=SHANK3))+geom_point()+geom_smooth(se=F)+theme_classic()
p
p <- ggplot(data=d, aes(x=Age, y=SHANK3))+geom_point()+geom_smooth(se=F)+theme_classic()+ylim(0,6.5)
p
gradethis::gradethis_demo()
?grade_conditions
?grade_result
??gradethis
?gradethis
install.packages("checkr")
devtools::install_github("lionel-/redpen")
library(redpen)
devtools::install_github("dtkaplan/checkr")
remove.packages("checkr")
devtools::install_github("dtkaplan/checkr")
